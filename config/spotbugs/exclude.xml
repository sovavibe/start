<?xml version="1.0" encoding="UTF-8"?>
<!--
    SpotBugs exclusion filter for strict mode.
    
    Exclusions are MINIMAL and SPECIFIC - only for:
    1. Framework-specific patterns (Jmix/Vaadin lifecycle methods)
    2. Specific Lombok-generated code issues (not all getters/setters/constructors)
    
    All exclusions are documented with justification.
    
    CRITICAL: Do NOT exclude all constructors or all getters/setters - this would hide real bugs!
-->
<FindBugsFilter>
    <!--
    Framework compatibility: Exclude specific SpotBugs issues for specific Jmix/Vaadin view classes
    Views contain framework-managed beans that are not serializable
    This is expected behavior for framework views
    Using specific class names instead of broad pattern for stricter control
    -->
    <Match>
        <Class name="~com\.digtp\.start\.view\..*View"/>
        <Bug pattern="SE_BAD_FIELD"/>
    </Match>
    
    <!--
    Framework compatibility: Exclude serialization issues for Spring Boot application class
    Application class contains framework dependencies that are not serializable
    -->
    <Match>
        <Class name="~com\.digtp\.start\.StartApplication"/>
        <Bug pattern="SE_BAD_FIELD"/>
    </Match>
    
    <!--
    Lombok/EclipseLink compatibility: Exclude EI/EI2/EI_EXPOSE_REP/EI_EXPOSE_REP2 for entity classes
    These warnings occur when Lombok-generated getters return mutable collections
    EclipseLink generates _persistence_* methods that are framework-managed
    This is acceptable for JPA entities where collections are managed by the framework
    Pattern matches entity classes in com.digtp.start.entity package
    Using separate Match blocks as pattern matching with | doesn't work reliably
    -->
    <Match>
        <Class name="~com\.digtp\.start\.entity\..*"/>
        <Bug pattern="EI"/>
    </Match>
    <Match>
        <Class name="~com\.digtp\.start\.entity\..*"/>
        <Bug pattern="EI2"/>
    </Match>
    <Match>
        <Class name="~com\.digtp\.start\.entity\..*"/>
        <Bug pattern="EI_EXPOSE_REP"/>
    </Match>
    <Match>
        <Class name="~com\.digtp\.start\.entity\..*"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>
    <!--
    EclipseLink generated code: Exclude ES (string comparison) for entity package
    EclipseLink generates _persistence_get methods that use == for field name comparison
    This is framework-generated code, not application code
    Using Package-level exclusion as SpotBugs cannot properly match generated bytecode methods
    Note: SpotBugs has known limitations with excluding generated bytecode methods via Class/Method filters
    -->
    <!--
    EclipseLink generated code: Exclude ES (string comparison) for entity classes
    EclipseLink generates _persistence_get methods that use == for field name comparison
    This is framework-generated code, not application code
    
    Using both ES and ES_COMPARING_PARAMETER_STRING_WITH_EQ patterns to ensure exclusion works.
    SpotBugs reports as ES but XML uses ES_COMPARING_PARAMETER_STRING_WITH_EQ.
    -->
    <Match>
        <Class name="~com\.digtp\.start\.entity\..*"/>
        <Bug pattern="ES"/>
    </Match>
    <Match>
        <Class name="~com\.digtp\.start\.entity\..*"/>
        <Bug pattern="ES_COMPARING_PARAMETER_STRING_WITH_EQ"/>
    </Match>
    
    <!--
    Framework lifecycle methods: Exclude specific issues for framework callbacks
    Jmix/Vaadin lifecycle methods may have patterns that trigger false positives
    Only exclude specific bug patterns, not all checks
    Using specific package pattern instead of broad class pattern
    -->
    <Match>
        <Class name="~com\.digtp\.start\.view\..*View"/>
        <Method name="onInit.*|onReady.*|onBeforeSave.*|onAfterSave.*|onValidation.*|onInitEntity.*"/>
        <Bug pattern="UWF_FIELD_NOT_INITIALIZED_IN_CONSTRUCTOR"/>
    </Match>
    
    <!--
    Framework compatibility: Exclude serialVersionUID warnings for Jmix/Vaadin views
    Views are framework-managed and don't need serialVersionUID
    Suppressed in code via @SuppressWarnings, but SpotBugs still reports
    Using both abbrev and full type name for maximum compatibility
    -->
    <Match>
        <Class name="~com\.digtp\.start\.view\..*View"/>
        <Bug pattern="SnVI"/>
    </Match>
    <Match>
        <Class name="~com\.digtp\.start\.view\..*View"/>
        <Bug pattern="SE_NO_SERIALVERSIONID"/>
    </Match>
    
    <!--
    Format string false positive: Exclude FS warnings for text blocks with formatted()
    SpotBugs incorrectly flags text blocks that use .formatted() as needing %n instead of \n
    Text blocks use actual newlines, not escape sequences
    -->
    <Match>
        <Class name="com.digtp.start.entity.User"/>
        <Method name="getDisplayName"/>
        <Bug pattern="FS_FORMAT_STRING_USE_NEWLINE"/>
    </Match>
    
    <!--
    Framework compatibility: Exclude RCN (Redundant nullcheck) for defensive null checks
    SpotBugs incorrectly flags defensive null checks as redundant
    This is intentional defensive programming for framework methods that can return null
    Using both abbrev and full type name for maximum compatibility
    -->
    <Match>
        <Class name="com.digtp.start.view.main.MainView"/>
        <Method name="isSubstituted"/>
        <Bug pattern="RCN"/>
    </Match>
    <Match>
        <Class name="com.digtp.start.view.main.MainView"/>
        <Method name="isSubstituted"/>
        <Bug pattern="RCN_REDUNDANT_NULLCHECK_OF_NONNULL_VALUE"/>
    </Match>
    
    <!--
    Singleton pattern: Exclude MS (expose internal representation) for PostgresTestContainer.getInstance()
    Singleton pattern intentionally returns INSTANCE - this is standard singleton implementation
    Using both abbrev and full type name for maximum compatibility
    -->
    <Match>
        <Class name="com.digtp.start.testsupport.PostgresTestContainer"/>
        <Method name="getInstance"/>
        <Bug pattern="MS"/>
    </Match>
    <Match>
        <Class name="com.digtp.start.testsupport.PostgresTestContainer"/>
        <Method name="getInstance"/>
        <Bug pattern="MS_EXPOSE_REP"/>
    </Match>
    
    <!--
    Test data: Exclude SECHCP (hard coded password) for test classes
    Test classes use hard-coded passwords for testing purposes - these are not production secrets
    Using both abbrev and full type name for maximum compatibility
    -->
    <Match>
        <Class name="~.*Test"/>
        <Bug pattern="SECHCP"/>
    </Match>
    <Match>
        <Class name="~.*Test"/>
        <Bug pattern="HARD_CODE_PASSWORD"/>
    </Match>
    
    <!--
    Test null-safety: Exclude NP (null passed for non-null parameter) for test methods
    Tests intentionally pass null to verify null-safety behavior - this is valid test practice
    Using both abbrev and full type name for maximum compatibility
    -->
    <Match>
        <Class name="~.*Test"/>
        <Bug pattern="NP"/>
    </Match>
    <Match>
        <Class name="~.*Test"/>
        <Bug pattern="NP_NONNULL_PARAM_VIOLATION"/>
    </Match>
    
    <!--
    Test uninitialized fields: Exclude UwF (uninitialized field) for test classes
    Test classes may have uninitialized fields that are set up in @BeforeEach or test methods
    This is acceptable for test classes
    -->
    <Match>
        <Class name="~.*Test"/>
        <Bug pattern="UwF"/>
    </Match>
    <Match>
        <Class name="~.*Test"/>
        <Bug pattern="UWF_NULL_FIELD"/>
    </Match>
    
    <!--
    Format string false positive: Exclude FS warnings for User entity getDisplayName method
    SpotBugs incorrectly flags text blocks that use .formatted() as needing %n instead of \n
    Text blocks use actual newlines, not escape sequences
    Method-level exclusion for precision
    Note: SpotBugs reports as "FS" but pattern name is "FS_FORMAT_STRING_USE_NEWLINE"
    -->
    <Match>
        <Class name="com.digtp.start.entity.User"/>
        <Method name="getDisplayName"/>
        <Bug pattern="FS"/>
    </Match>
    <Match>
        <Class name="com.digtp.start.entity.User"/>
        <Method name="getDisplayName"/>
        <Bug pattern="FS_FORMAT_STRING_USE_NEWLINE"/>
    </Match>
</FindBugsFilter>