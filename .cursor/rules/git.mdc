---
globs: ["**/*.md", "**/*.java", "**/*.gradle", "**/*.properties", ".github/**"]
version: "2.0.0"
---

# GIT & CI/CD

## CONVENTIONAL COMMITS
**Format**: `<type>[scope]: <description>` | Optional body | Optional footer(s) | **Types**: feat | fix | docs | style | refactor | perf | test | build | ci | chore | revert | **Scopes**: Framework & UI: jmix | vaadin | ui | frontend | Application: entity | view | service | api | Infrastructure: config | db | docker | kubernetes | k8s | helm | observability | Security: security | auth | Database: liquibase | migration | Quality: test | checkstyle | pmd | spotbugs | sonar | quality | format | lint | CI/CD: ci | github | workflow | Dependencies: deps | gradle | npm | node | Docs & Scripts: docs | scripts | makefile | husky | commitlint | Other: copyright | rules | cleanup | logging | metrics | monitoring | **Rules**: Imperative mood: "add" not "added"/"adds" | Lowercase, no period, max 72 chars (50 preferred) | Body: WHAT/WHY, wrap 72, bullets for multiple | Footer: `BREAKING CHANGE:`, `Closes #123`, `Fixes #456` | Breaking: `type!:` or footer `BREAKING CHANGE:` | **Prohibitions**: ❌ Past/present tense | Period at end | Vague | Multiple types | Uppercase type

## BRANCH NAMING
**Format**: `<type>/<scope>-<description>` | `<type>/task-<number>/<description>` | `<type>/<scope>-task-<number>/<description>` | **Special cases**: For `docs` type, scope is optional: `docs/<description>` or `docs/<scope>-<description>` | Task format: `<type>/task-<number>/<description>` or `<type>/<scope>-task-<number>/<description>` (scope optional) | **Types**: feat | fix | docs | refactor | perf | test | build | chore | revert | **Scopes** (Jmix/Vaadin): jmix | vaadin | entity | view | service | security | liquibase | ui | api | db | config | test | ci | deps | docs | **Rules**: Lowercase, kebab-case (hyphens) | Max 50 chars (excluding type/scope prefix) | Descriptive: what the branch does | No special characters except hyphens | No trailing slashes or dots | **Prohibitions**: ❌ Uppercase | Spaces | Underscores | Special chars | Vague names | Periods | Trailing slashes | ❌ `feature/`, `bugfix/`, `hotfix/` (use `feat/`, `fix/` instead) | ❌ `master`, `main`, `develop` (protected branches) | **Validation**: Standard format: `^(feat|fix|docs|refactor|perf|test|build|chore|revert)/(jmix|vaadin|entity|view|service|security|liquibase|ui|api|db|config|test|ci|deps|docs)-[a-z0-9-]+$` | Docs with optional scope: `^docs/[a-z0-9-]+$` (allows `docs/add-...` pattern) | Task format: `^(feat|fix|docs|refactor|perf|test|build|chore|revert)/task-[0-9]+/[a-z0-9-]+$` | Task format with scope: `^(feat|fix|docs|refactor|perf|test|build|chore|revert)/(jmix|vaadin|entity|view|service|security|liquibase|ui|api|db|config|test|ci|deps|docs)-task-[0-9]+/[a-z0-9-]+$` | Enforced in GitHub Actions | Blocks merge if invalid

## GITHUB WORKFLOW
**Authentication & Repository**: Authentication: ✅ Use `gh auth login --with-token` for token authentication | ✅ Tokens stored in system keyring (NOT in code/.env) | ✅ Use `gh auth switch` to switch between accounts | ✅ Run `gh auth setup-git` after authentication | Repository Operations: ✅ Create repo: `gh repo create <name> --public --source=. --remote=origin` | ✅ View repo: `gh repo view --web` | ✅ Clone: `gh repo clone <owner>/<repo>` | **Commits & Branches**: Commits: ✅ ALWAYS use Conventional Commits format | Format: `<type>[scope]: <description>` | Types: feat, fix, docs, refactor, test, chore, perf, style, build, ci, revert | Scopes: jmix, vaadin, entity, view, service, security, liquibase, ui, api, db, config, test, ci, deps, docs, scripts, gradle, copyright | Enforced via commitlint in GitHub Actions | Branch Workflow: 1) Create branch: `git checkout -b feat/scope-description` | 2) Make changes and commit: `git commit -m "feat(scope): description"` | 3) Push branch: `git push -u origin feat/scope-description` | 4) Create PR: `./scripts/create-pr.sh` (auto-generates description from diff) | 5) After review: `gh pr merge --squash` | Branch Naming: Format: `<type>/<scope>-<description>` or `<type>/task-<number>/<description>` | Types: feat, fix, docs, refactor, perf, test, build, chore, revert | Scopes: jmix, vaadin, entity, view, service, security, liquibase, ui, api, db, config, test, ci, deps, docs | Special: For `docs` type, scope is optional | Task format: `<type>/task-<number>/<description>` or `<type>/<scope>-task-<number>/<description>` | ❌ Enforced in GitHub Actions (blocks merge if invalid) | **Pull Requests & Dependabot**: Pull Requests: ✅ Create: `./scripts/create-pr.sh` (auto-generates description from diff) | ✅ Create manual: `gh pr create --title "Title" --body "Description"` | ✅ List: `gh pr list` | ✅ View: `gh pr view <number>` | ✅ Merge: `gh pr merge <number> --squash` | ✅ SpotBugs review: Added automatically when PR is opened (see `.github/workflows/pr-spotbugs-review.yml`) | Dependabot: ✅ One PR per ecosystem (gradle, github-actions, docker) with groups | ✅ Group all updates (patch + minor) in single PR per ecosystem | ✅ Limit open PRs: 1 per ecosystem | ✅ Monthly schedule for non-critical updates | ✅ Manual review for all PRs (no auto-merge) | ✅ Major updates ignored automatically (require manual review) | **Issues & Security**: Issues: ✅ Create: `gh issue create --title "Title" --body "Description"` | ✅ List: `gh issue list` | ✅ View: `gh issue view <number>` | ✅ Close: `gh issue close <number>` | Security: ❌ NEVER commit tokens to code | ❌ NEVER add tokens to .env files | ❌ NEVER share tokens publicly | ✅ Tokens in system keyring only | ✅ Use `gh auth login` for authentication | **Quick Commands**: `gh status` (check auth status) | `gh repo view --web` (open repo in browser) | `gh pr create` (create pull request) | `gh issue create` (create issue)

## CI/CD
**GitHub Actions**: Latest stable versions, pin major versions (v5, v6), enable caching | Parallelization: Split jobs (format-check, code-quality, test, build) | Timeouts: 10-30 min for all jobs | Dependabot: Group updates, limit PRs, monthly schedule, auto-merge safe updates | Security: Use GITHUB_TOKEN, scan dependencies (Trivy, OWASP), upload SARIF reports | Commitlint: Enforced via GitHub Actions | Branch naming: Enforced via GitHub Actions | PR creation: Use `./scripts/create-pr.sh` | **SonarCloud**: When modifying `config/sonar-project.properties`, **MUST**: 1) Run `make sonar` to apply settings | 2) **CRITICAL**: Inform user to sync IntelliJ IDEA if using Connected Mode (Settings → Tools → SonarLint → Project Settings → "Update binding" or File → Invalidate Caches / Restart) | 3) Settings apply automatically in CI/CD, but IDE Connected Mode requires manual sync | 4) If user reports SonarLint issues after config changes, remind about sync step
