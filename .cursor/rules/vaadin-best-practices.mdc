---
globs: ["**/view/**/*.java", "**/view/**/*.xml", "**/*View*.java", "**/*Component*.java"]
autoFix: true
version: "8.0.0"
---

# VAADIN BEST PRACTICES

## LIFECYCLE
@Route: Constructor (DI+UI) → beforeEnter → afterNavigation → onDetach | @UIScope: Constructor (data) → onAttach (hasBeenInitialized) → onDetach (Registration.remove)

## PERFORMANCE
Lazy: grid.setItems(query→service.find(PageRequest)) | Virtual: grid.setPageSize(50) | Smart refresh: track state

## SECURITY
@AnonymousAllowed/@PermitAll/@RolesAllowed on @Route | Check permissions in beforeEnter() | Hidden != secure | getTranslation() auto-escapes | Html() only trusted

## @UIScope
Use: @Component + reused + needs UI.getCurrent() | Don't: @Route, Dialogs, Stateless | @UIScope = tab, @SessionScope = shared

## DIALOG
✅ new Dialog() each time | ❌ @Component extends Dialog = singleton corruption

## ANTIPATTERNS
getTranslation() in @UIScope constructor → NPE | Listeners no cleanup → leak | grid.setItems(all) >100 → OOM | @Component + Dialog → singleton | removeAll() + add(same) → leak | @PostConstruct @UIScope → UI not ready | onAttach without hasBeenInitialized → double init

## UI/UX
Material Design-inspired, calm palette | Components: Jmix UiComponents factory | Responsive: Mobile-first, breakpoints | Accessibility: ARIA labels, keyboard nav | Loading: Progress indicators, skeleton screens | Error: User-friendly messages, validation feedback | I18n: Messages service, externalize strings

## PWA
@PWA(name, shortName, iconPath, backgroundColor, themeColor, offlinePath) | AppShell implements AppShellConfigurator | Icons: 192x192, 512x512 | HTTPS production (mandatory) | Offline: src/main/webapp/offline.html
